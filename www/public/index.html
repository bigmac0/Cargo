<!doctype html>
<!-- Dec 31, 2019 -->
<!-- Happy NYE! -->
<meta charset="utf-8">
<!--<link rel="stylesheet" href="/static/css/bootstrap.min.css">-->
<link rel="stylesheet" href="/static/css/codemirror.css">
<link rel="stylesheet" href="/static/css/tomorrow-night-bright.css">
<link rel="stylesheet" href="/static/css/fullscreen.css">
<link rel="stylesheet" href="/static/css/foldgutter.css">
<link rel="stylesheet" href="/static/css/style.css">
<!-- Layout -->
<!-- Layout: Main Container -->
<div id="loader">Loading...</div>
<div id="main">
  <div id="editor">
    <div id="editor_toolbar">
      <select id="editor_selector">
        <option>**custom**</option>
        <option>nearest-neighbor</option>
      </select>
      <ul>
        <li id="editor_toolbar_reset">reset</li>
        <li class="box nocursor">load *.cc/*.cpp<input id="editor_toolbar_load_cpp" type="file"></li>
        <li class="box nocursor">load *.h<input id="editor_toolbar_load_h" type="file"></li>
        <!--<li id="editor_toolbar_saveall">save all...</li>-->
      </ul>
      <span id="editor_toolbar_close">Close Editor</span>
      <span>(press F11 within code editor to toggle fullscreen)</span>
    </div>
    <div id="editor_window">
      <div id="editor_cpp">
        <textarea id="editor_cpp_container"></textarea>
      </div>
      <div id="editor_h">
        <textarea id="editor_h_container"></textarea>
      </div>
    </div>
  </div>
  <div id="log">
    <div id="log_window">
        <div id="log_cargo">
          <textarea id="cargofeed" readonly noresize>cargo</textarea>
        </div>
        <div id="log_alg">
          <textarea id="algfeed" readonly noresize>rsalgorithm</textarea>
        </div>
    </div>
  </div>
  <footer>Welcome to CargoWeb</footer>
</div>
<!-- Visualization: Vertex Shader -->
<script type="x-shader/x-vertex" id="vertexshader">
  uniform float t;       // current time
  uniform float zoom;    // camera zoom

  attribute vec3 target0;
  attribute vec3 target1;
  attribute float dur0;  // time from position->target0 (weight/speed); sec
  attribute float dur1;  // time from target0 ->target1 (weight/speed); sec
  attribute float t0;    // time when targets received
  attribute float load;

  varying float vload;   // (cannot be int for some reason)

  void main() {
    vload = load;
    gl_PointSize = 3.0*zoom;
    float progress = (t-t0)/dur0;
    //if (progress > 1.0) progress = 1.0;  // remove me
    if (progress > 1.0) {  // reached target0, move toward target1
      progress = (t - t0 - dur0)/dur1;
      vec3 v = target0 + (target1 - target0)*progress;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(v, 1.0);
    } else {  // move toward target0
      vec3 v = position + (target0 - position)*progress;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(v, 1.0);
    }
    // gl_Position = projectionMatrix * modelViewMatrix * vec4(target0, 1.0);
  }
</script>
<script type="x-shader/x-vertex" id="vertexshader_cust">
  uniform float zoom;
  attribute float size;
  void main() {
    gl_PointSize = size*zoom;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
</script>
<!-- Visualization: Fragment Shader -->
<script type="x-shader/x-fragment" id="fragmentshader">
  varying float vload;
  const vec4 dark = vec4(0.24, 0.24, 0.32, 1.0);
  const vec4 grey = vec4(0.5, 0.5, 0.5, 0.7);
  const vec4 blue = vec4(0.15, 0.55, 0.82, 1.0);
  const vec4 yellow = vec4(0.70, 0.54, 0.0, 1.0);
  const vec4 red = vec4(0.86, 0.20, 0.18, 1.0);
  const vec4 magenta = vec4(0.83, 0.21, 0.51, 1.0);

  void main() {
    // Color based on load
    vec4 color = dark;
    if (vload >= 1.0 && vload < 2.0)
      color = blue;
    if (vload >= 2.0 && vload < 3.0)
      color = yellow;
    if (vload >= 3.0)
      color = red;

    // Make it a circle by discarding fragments outside a radius
    // https://www.desultoryquest.com/blog/drawing-anti-aliased-circular-points-using-opengl-slash-webgl/
    float r = 0.0;
    //float border = 0.2;
    vec2 cxy = 2.0 * gl_PointCoord - 1.0;
    r = dot(cxy, cxy);
    // Add drop shadow
    // gl_FragColor = color;
    // if (r > 1.0 - border) {
    //   gl_FragColor = vec4(0,0,0,0.3);
    // }
    if (r > 1.0)
      discard;
    gl_FragColor = color;
  }
</script>
<script type="x-shader/x-fragment" id="fragmentshader_cust">
  void main() {
    gl_FragColor = vec4(0.83, 0.21, 0.51, 1.0);
  }
</script>
<script src="/socket.io/socket.io.js"></script>
<script src="/static/js/codemirror.js"></script>
<script src="/static/js/clike.js"></script>
<script src="/static/js/fullscreen.js"></script>
<script src="/static/js/foldcode.js"></script>
<script src="/static/js/foldgutter.js"></script>
<script src="/static/js/indent-fold.js"></script>
<script src="/static/js/brace-fold.js"></script>
<script src="/static/js/template.js"></script>
<script src="/static/js/three.min.js"></script>
<script src="/static/js/MapControls.js"></script>
<script src="/static/js/Stats.js"></script>
<script src="/static/js/dat.gui.min.js"></script>
<script src="/static/js/bj5_positions.js"></script>
<script src="/static/js/bj5_nodes.js"></script>
<script src="/static/js/bj5_weights.js"></script>
<script src="/static/js/cd1_positions.js"></script>
<script src="/static/js/cd1_nodes.js"></script>
<script src="/static/js/cd1_weights.js"></script>
<script src="/static/js/mny_positions.js"></script>
<script src="/static/js/mny_nodes.js"></script>
<script src="/static/js/mny_weights.js"></script>
<script src="/static/js/dat.gui.min.js"></script>
<script src="/static/js/index.js"></script>

