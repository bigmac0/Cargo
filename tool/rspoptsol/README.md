Seems to work but very slow
